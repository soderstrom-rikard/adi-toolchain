Merged up to 20727, excluding the following revisions for now:

19342
19343
19344
19345
19346
19347
19386

The excluded ones are the uc_malloc work which IMO is misguided and shouldn't
be applied to our tree.
